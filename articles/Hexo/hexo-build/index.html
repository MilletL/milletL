<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>搬瓦工VPS搭建自己的Hexo博客 | RiceEater的小小世界 | My Life&#39;s Getting Better.</title>

  
  <meta name="author" content="小米粒">
  

  
  <meta name="description" content="之前为了上一些不存在的网站，在搬瓦工上花费19.99刀买了一年VPS。最近感觉主机只用来FQ有些浪费，正好近来有写博客的需求，就在NameCheap上买了域名，准备搭建自己的博客系统。尝试了WordPress、Ghost等系统后，决定使用Hexo。下面就把自己搭建的过程和中途遇到的坑写下来，算是个存档。
服务器设置在搬瓦工购买VPS后，通过网站右上角Client Area-Services-My Services可以看到自己购买的主机。通过KiviVM Control Panel可以对主机进行一些简单的操作，比如重装系统、更换机房等等(关于搬瓦工的详细内容，可以在搬瓦工中文网进行了解)。
进行服务器设置之前可以先进行系统的重装，我这里选择了centOS6，开始重装前，在Main controls里停掉当前主机，然后选择合适的linux发行版本，点击reload进行重装。几分钟后安装完成，记下root密码和SSH端口(一般是29962)。
我这里顺带给主机安装了宝塔面板，安装过程很简单，使用putty或者类似工具连接主机，跟官网文档走就可以，可能会有些耗时。安装宝塔成功后，登录宝塔面板，看自己需求安装LNMP或者单单安装Nginx。
ps:安装完宝塔后宝塔的防火墙可能会拦截某些端口，如果安装完你发现你的ss不能使用，请在面板-安全中放行ss端口。">
  

  
  <meta name="keywords" content="RiceEater 小米粒 riceeater.info">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="搬瓦工VPS搭建自己的Hexo博客"/>

  <meta property="og:site_name" content="RiceEater的小小世界"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="RiceEater的小小世界" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">RiceEater的小小世界</a>
    </h1>
    <p class="site-description">My Life&#39;s Getting Better.</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/plans">计划</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>搬瓦工VPS搭建自己的Hexo博客</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/articles/Hexo/hexo-build/" rel="bookmark">
        <time class="entry-date published" datetime="2018-10-08T11:52:43.000Z">
          2018-10-08
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>之前为了上一些不存在的网站，在<a target="_blank" rel="noopener" href="https://bwh1.net/">搬瓦工</a>上花费19.99刀买了一年VPS。最近感觉主机只用来FQ有些浪费，正好近来有写博客的需求，就在<a target="_blank" rel="noopener" href="https://www.namecheap.com/">NameCheap</a>上买了域名，准备搭建自己的博客系统。尝试了WordPress、Ghost等系统后，决定使用Hexo。下面就把自己搭建的过程和中途遇到的坑写下来，算是个存档。</p>
<h3 id="服务器设置"><a href="#服务器设置" class="headerlink" title="服务器设置"></a>服务器设置</h3><p>在<a target="_blank" rel="noopener" href="https://bwh1.net/">搬瓦工</a>购买VPS后，通过网站右上角Client Area-Services-My Services可以看到自己购买的主机。通过KiviVM Control Panel可以对主机进行一些简单的操作，比如重装系统、更换机房等等(关于搬瓦工的详细内容，可以在<a target="_blank" rel="noopener" href="http://banwagong.cn/">搬瓦工中文网</a>进行了解)。</p>
<p>进行服务器设置之前可以先进行系统的重装，我这里选择了centOS6，开始重装前，在Main controls里停掉当前主机，然后选择合适的linux发行版本，点击reload进行重装。几分钟后安装完成，记下root密码和SSH端口(一般是29962)。</p>
<p>我这里顺带给主机安装了<a href="www.bt.cn">宝塔面板</a>，安装过程很简单，使用putty或者类似工具连接主机，跟官网文档走就可以，可能会有些耗时。安装宝塔成功后，登录宝塔面板，看自己需求安装LNMP或者单单安装Nginx。</p>
<p>ps:安装完宝塔后宝塔的防火墙可能会拦截某些端口，如果安装完你发现你的ss不能使用，请在面板-安全中放行ss端口。</p>
<a id="more"></a>

<h3 id="本地设置"><a href="#本地设置" class="headerlink" title="本地设置"></a>本地设置</h3><p>我的本地环境使用的Windows 10，因此下面所讲的都是基于windows 10的PC</p>
<h4 id="安装和配置Git"><a href="#安装和配置Git" class="headerlink" title="安装和配置Git"></a>安装和配置Git</h4><p><a target="_blank" rel="noopener" href="https://git-scm.com/downloads">下载</a>适合自己系统的Git版本，一路下一步即可。</p>
<p>安装完成后，需要对Git进行配置，我们使用git bash来设置自己的用户名和email信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">$ git config --global user.email <span class="string">&quot;email@example.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>接下来需要生成密钥文件，具体代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C <span class="string">&quot;email@example.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>github上也有关于密钥生成和使用的<a target="_blank" rel="noopener" href="https://help.github.com/articles/connecting-to-github-with-ssh/">相关说明</a></p>
<h4 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h4><p><a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download/">下载</a>适合自己系统的Node版本，我这里选择的可执行文件。windows的安装过程没什么好说的，一路next即可，注意中间有个选项Add to path，是添加环境变量的，一定要点上。</p>
<h4 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h4><p>打开git bash，在命令行里输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>等待安装完成，这时候在本地的安装工作就结束了，接下来进行Hexo的相关配置</p>
<h4 id="配置Hexo"><a href="#配置Hexo" class="headerlink" title="配置Hexo"></a>配置Hexo</h4><p>Hexo<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">常用命令</a></p>
<p>新建博客站点，将&lt;folder&gt;替换为你想创建博客的地址，比如我这里使用的是D:\hexo\blog，命令就是 </p>
<p><strong>hexo init /d/hexo/blog</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init &lt;folder&gt;</span><br><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>

<p>创建完成后，文件目录如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml 配置文件</span><br><span class="line">├── package.json 应用程序信息，默认安装了EJS, Stylus 和 Markdown renderer</span><br><span class="line">├── scaffolds 模板文件夹</span><br><span class="line">├── source 资源文件位置</span><br><span class="line">|   ├── _drafts</span><br><span class="line">|   └── _posts</span><br><span class="line">└── themes 主题文件夹</span><br></pre></td></tr></table></figure>

<p>如果需要修改博客标题和副标题，可以打开_config.yml修改title字段和subtitle字段。Hexo默认语言为英文，若需要修改，同样打开_config.yml，修改language: zh-Hans就是设置为简体中文。更多设置，参见<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/configuration.html">Hexo配置文档</a>。</p>
<p><strong>ps:这里需要注意，修改yml文件内容时，要在冒号:和后面value之间加一个空格，否则会报错</strong></p>
<h4 id="替换主题"><a href="#替换主题" class="headerlink" title="替换主题"></a>替换主题</h4><p>Hexo支持多种主题，你可以在<a target="_blank" rel="noopener" href="https://hexo.io/themes/">主题列表</a>中选择自己喜欢的主题使用，这里以最流行的<a target="_blank" rel="noopener" href="http://theme-next.iissnan.com/">Next</a>为例，替换主题的操作非常简单:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<p>之后打开博客根目录下的_config.yml，修改thems: 为thems: next，next主题支持四种不同样式，可以修改themes/next/_config.yml中的scheme来进行切换。</p>
<p><strong>Next主题的相关设置可以在<a target="_blank" rel="noopener" href="http://www.aisun.org/2017/10/hexo-next+dingzhi/">知了笔记</a>进行查看。</strong></p>
<h4 id="新建博文并预览效果"><a href="#新建博文并预览效果" class="headerlink" title="新建博文并预览效果"></a>新建博文并预览效果</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ hexo new <span class="string">&quot;your_blog_title&quot;</span></span><br></pre></td></tr></table></figure>

<p>这个命令是用于在source/_posts下生成一个命名的.md文件，效果等同于新建.md文件并拷贝至该处。</p>
<p>接下来我们将这个新建的博文生成静态文件并部署到本地来预览效果，过程也很简单：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo server --debug</span><br></pre></td></tr></table></figure>

<p>generate命令用于将md文件生成静态网页，server命令用于将博客系统发布到本地4000端口，这两个命令都可以进行简写，写作hexo g和hexo s。</p>
<p>ps:有时会出现4000端口被其他进程占用的问题，这里有两种解决方案：1.解除其他进程端口占用，2.使用hexo server -p 5000来修改端口并预览</p>
<p>上述命令完成后，就可以打开浏览器，输入<a target="_blank" rel="noopener" href="http://localhost:4000/">localhost:4000</a>就可以预览你刚刚生成的博文啦。</p>
<p><img src="http://p6wdgbaao.bkt.clouddn.com/preview.png?attname=&e=1523246235&token=Out1w4frO6v0_9UUlgEhTaFGEb8Of-3YMx423K27:AeVjTjWFdsfEttPfoaPUAJwTmRs"></p>
<h3 id="仓库设置"><a href="#仓库设置" class="headerlink" title="仓库设置"></a>仓库设置</h3><p>现在我们已经可以将博客系统在本机上进行模拟了，接下来我们就要将其部署到我们的VPS上。在此之前需要将代码托管至github等托管平台，我这里使用了github和coding.net。</p>
<h4 id="github"><a href="#github" class="headerlink" title="github"></a>github</h4><p>新建一个项目，命名为***.github.io，***为你的github用户名，无脑下一步即可。</p>
<p>上传你的SSH Key到github，具体参见<a target="_blank" rel="noopener" href="https://help.github.com/articles/connecting-to-github-with-ssh/">GithubHelp</a></p>
<h4 id="Coding-net"><a href="#Coding-net" class="headerlink" title="Coding.net"></a>Coding.net</h4><p>新建空仓库，命名随意，随后上传你的SSH Key到Coding.net，比github还要简单，略过。</p>
<h4 id="Hexo设置部署到远程仓库"><a href="#Hexo设置部署到远程仓库" class="headerlink" title="Hexo设置部署到远程仓库"></a>Hexo设置部署到远程仓库</h4><p>接下来我们要设置将我们的blog目录整个提交到远端，打开根目录下的_config.yml，编辑如下一部分内容，切记将***替换成你自己的地址：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> </span><br><span class="line">    <span class="attr">github:</span> <span class="string">git@github.com:***/***.github.io.git,master</span></span><br><span class="line">    <span class="attr">coding:</span> <span class="string">git@git.coding.net:***/***.git,master</span></span><br></pre></td></tr></table></figure>

<p>保存后打开Git bash，输入以下命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>

<p>前者是生成静态页面，后者是将代码提交到远端仓库，也就是我们刚刚设置的github与coding。</p>
<p>提交完成后打开你刚刚设置的github.io，是不是看到写好的博客了。</p>
<h3 id="VPS拉取代码并绑定域名"><a href="#VPS拉取代码并绑定域名" class="headerlink" title="VPS拉取代码并绑定域名"></a>VPS拉取代码并绑定域名</h3><p>我的vps使用的centOS，安装了宝塔面板，所以我采用了最简单的方式来绑定域名（前提是已经安装Nginx），当然你也可以不使用面板，使用命令行修改Nignx配置文件也是一样的效果。</p>
<p>宝塔面板点击网站-添加站点-输入域名，根目录，保存。</p>
<p>我这里根目录保存在/www/wwwroot/blog下。这时访问域名就会提示Nginx设置错误，先不管。</p>
<p>打开宝塔面板-文件，进入/www/wwwroot/blog，在该目录打开命令行，或者ssh打开命令行，进入该目录下。</p>
<p>输入命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> git@github.com:riceeater/riceeater.github.io.git</span><br></pre></td></tr></table></figure>

<p>拉去完成后，再次访问你的域名，你就会发现博客系统已经部署上去了。</p>
<p>ps:你需要在VPS上重复<a target="_blank" rel="noopener" href="https://help.github.com/articles/connecting-to-github-with-ssh/">上传SSH key到github的步骤</a></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>到这里，我们在VPS上搭建自己的博客系统这一目标就基本实现了。</p>
<p>现在我们的创建流程是这样，本地机器打开命令行，使用hexo new新建博文，使用MarkDown工具编辑.md文件，使用hexo g命令生成静态文件，hexo d将代码push到远端仓库，再登录宝塔，打开blog所在目录输入命令行git pull。完成整个流程。</p>
<p>过程比较繁琐，我们后期可以加上webHook来实现自动化部署，即本机提交到github后，webHook会通知vps拉取最新代码，当然这个过程我们放到后面再说（其实是我还没搞懂）。</p>
<p>顺便推荐一个MarkDown工具<a target="_blank" rel="noopener" href="https://www.typora.io/">Typora</a>，简洁美观，如果官网打不开，点击<a target="_blank" rel="noopener" href="https://download.csdn.net/download/xiaomi987/10336142">备份下载地址</a>。</p>
<p>See you~</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/教程/">教程</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/hexo/">hexo</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2020 小米粒
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>