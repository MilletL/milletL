<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Androidåˆ—è¡¨æ‹–æ‹½æ’åºåŠç¦æ­¢æ‹–æ‹½ä»¥åŠä¿å­˜æ’åºçŠ¶æ€ | RiceEaterçš„å°å°ä¸–ç•Œ | My Life&#39;s Getting Better.</title>

  
  <meta name="author" content="å°ç±³ç²’">
  

  
  <meta name="description" content="ä»Šå¤©æ¥ç ”ç©¶ä¸€ä¸‹Androidä¸­æ‹–æ‹½æ’åºçš„ç›¸å…³æŠ€æœ¯ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒRecyclerViewæ˜¯ä¸€ä¸ªååˆ†å¼ºå¤§çš„ç±»ï¼Œå®ƒå¯ä»¥å®ç°ListViewçš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶ä¸”æ›´æ˜“ç”¨ã€‚å…³äºå®ƒçš„å¥½å¤„ä¸å¿…å¤šè¯´ï¼Œæ‡‚çš„éƒ½æ‡‚ã€‚æˆ‘ä»¬åŸºäºRecyclerViewæ¥å®Œæˆä¸€ä¸ªå¯æ‹–æ‹½æ’åºçš„åˆ—è¡¨ï¼Œå¹¶ä¸”åœ¨æ‹–æ‹½ä¹‹åä¿å­˜åˆ—è¡¨çŠ¶æ€ï¼Œè¿™ä¸€åŠŸèƒ½åœ¨å¼€å‘éœ€æ±‚ä¸­åº”è¯¥ä½¿ç”¨åˆ°çš„è¿˜æ˜¯è›®å¤šçš„ã€‚
å‡†å¤‡å¼€å§‹è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œè‚¯å®šæ˜¯è¦å…ˆå®Œæˆä¸€éƒ¨åˆ†çŸ¥è¯†å‚¨å¤‡ã€‚å¥½äº†ï¼Œå¼€å§‹å­¦ä¹ ~ğŸ˜³

é¦–å…ˆï¼ŒRecyclerViewä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ‹–æ‹½å’Œæ»‘åŠ¨åˆ é™¤çš„å¸®åŠ©ç±»ï¼Œè¿™ä¸ªç±»ä½äºandroid.support.v7.widget.helperåŒ…ä¸‹ï¼Œç±»åæ˜¯ItemTouchHelperã€‚æˆ‘ä»¬è‹¥è¦ä½¿ç”¨RecyclerViewçš„æ‹–æ‹½ï¼Œå¯ä»¥å¤å†™è¿™ä¸ªç±»ï¼Œå°†åˆå§‹åŒ–å¥½çš„å¯¹è±¡ä¸RecyclerViewç»‘å®šã€‚ä½†å…¶å®ItemTouchHelperå¹¶éæˆ‘ä»¬è¦å…³æ³¨çš„é‡ç‚¹ï¼Œå› ä¸ºä¸€èˆ¬æˆ‘ä»¬åªéœ€è¦ç»§æ‰¿æ­¤ç±»ï¼Œç”¨å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬çœŸæ­£å»æ§åˆ¶æ»‘åŠ¨å’Œæ‹–æ‹½çš„ç±»åœ¨å“ªå‘¢ï¼Ÿæˆ‘ä»¬ä»ItemTouchHelperçš„æ„é€ æ–¹æ³•å¯ä»¥çœ‹å‡ºä¸€ç‚¹ç«¯å€ªï¼š
123456789101112/**     * Creates an ItemTouchHelper that will work with the given Callback.     * &amp;lt;p&amp;gt;     * You can attach ItemTouchHelper to a RecyclerView via     * &amp;#123;@link #attachToRecyclerView(RecyclerView)&amp;#125;. Upon attaching, it will add an item decoration,     * an onItemTouchListener and a Child attach / detach listener to the RecyclerView.     *     * @param callback The Callback which controls the behavior of this touch helper.     */public ItemTouchHelper(Callback callback) &amp;#123;    mCallback = callback;&amp;#125;">
  

  
  <meta name="keywords" content="RiceEater å°ç±³ç²’ riceeater.info">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Androidåˆ—è¡¨æ‹–æ‹½æ’åºåŠç¦æ­¢æ‹–æ‹½ä»¥åŠä¿å­˜æ’åºçŠ¶æ€"/>

  <meta property="og:site_name" content="RiceEaterçš„å°å°ä¸–ç•Œ"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="RiceEaterçš„å°å°ä¸–ç•Œ" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">RiceEaterçš„å°å°ä¸–ç•Œ</a>
    </h1>
    <p class="site-description">My Life&#39;s Getting Better.</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/archives">å½’æ¡£</a></li>
      
        <li><a href="/plans">è®¡åˆ’</a></li>
      
        <li><a href="/about">å…³äº</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>Androidåˆ—è¡¨æ‹–æ‹½æ’åºåŠç¦æ­¢æ‹–æ‹½ä»¥åŠä¿å­˜æ’åºçŠ¶æ€</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/articles/Android/View/DraggingSortDemo/" rel="bookmark">
        <time class="entry-date published" datetime="2018-05-25T12:15:55.000Z">
          2018-05-25
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>ä»Šå¤©æ¥ç ”ç©¶ä¸€ä¸‹Androidä¸­æ‹–æ‹½æ’åºçš„ç›¸å…³æŠ€æœ¯ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œ<code>RecyclerView</code>æ˜¯ä¸€ä¸ªååˆ†å¼ºå¤§çš„ç±»ï¼Œå®ƒå¯ä»¥å®ç°<code>ListView</code>çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶ä¸”æ›´æ˜“ç”¨ã€‚å…³äºå®ƒçš„å¥½å¤„ä¸å¿…å¤šè¯´ï¼Œæ‡‚çš„éƒ½æ‡‚ã€‚æˆ‘ä»¬åŸºäº<code>RecyclerView</code>æ¥å®Œæˆä¸€ä¸ªå¯æ‹–æ‹½æ’åºçš„åˆ—è¡¨ï¼Œå¹¶ä¸”åœ¨æ‹–æ‹½ä¹‹åä¿å­˜åˆ—è¡¨çŠ¶æ€ï¼Œè¿™ä¸€åŠŸèƒ½åœ¨å¼€å‘éœ€æ±‚ä¸­åº”è¯¥ä½¿ç”¨åˆ°çš„è¿˜æ˜¯è›®å¤šçš„ã€‚</p>
<h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><p>å¼€å§‹è¿™ä¸ªåŠŸèƒ½ä¹‹å‰ï¼Œè‚¯å®šæ˜¯è¦å…ˆå®Œæˆä¸€éƒ¨åˆ†çŸ¥è¯†å‚¨å¤‡ã€‚å¥½äº†ï¼Œå¼€å§‹å­¦ä¹ ~ğŸ˜³</p>
<p><img src="/images/%E5%B4%A9%E6%BA%83.png"></p>
<p>é¦–å…ˆï¼Œ<code>RecyclerView</code>ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ‹–æ‹½å’Œæ»‘åŠ¨åˆ é™¤çš„å¸®åŠ©ç±»ï¼Œè¿™ä¸ªç±»ä½äº<code>android.support.v7.widget.helper</code>åŒ…ä¸‹ï¼Œç±»åæ˜¯<code>ItemTouchHelper</code>ã€‚æˆ‘ä»¬è‹¥è¦ä½¿ç”¨<code>RecyclerView</code>çš„æ‹–æ‹½ï¼Œå¯ä»¥å¤å†™è¿™ä¸ªç±»ï¼Œå°†åˆå§‹åŒ–å¥½çš„å¯¹è±¡ä¸<code>RecyclerView</code>ç»‘å®šã€‚ä½†å…¶å®<code>ItemTouchHelper</code>å¹¶éæˆ‘ä»¬è¦å…³æ³¨çš„é‡ç‚¹ï¼Œå› ä¸ºä¸€èˆ¬æˆ‘ä»¬åªéœ€è¦ç»§æ‰¿æ­¤ç±»ï¼Œç”¨å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬çœŸæ­£å»æ§åˆ¶æ»‘åŠ¨å’Œæ‹–æ‹½çš„ç±»åœ¨å“ªå‘¢ï¼Ÿæˆ‘ä»¬ä»<code>ItemTouchHelper</code>çš„æ„é€ æ–¹æ³•å¯ä»¥çœ‹å‡ºä¸€ç‚¹ç«¯å€ªï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates an ItemTouchHelper that will work with the given Callback.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * You can attach ItemTouchHelper to a RecyclerView via</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #attachToRecyclerView(RecyclerView)&#125;. Upon attaching, it will add an item decoration,</span></span><br><span class="line"><span class="comment">     * an onItemTouchListener and a Child attach / detach listener to the RecyclerView.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> callback The Callback which controls the behavior of this touch helper.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ItemTouchHelper</span><span class="params">(Callback callback)</span> </span>&#123;</span><br><span class="line">    mCallback = callback;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>æ„é€ æ–¹æ³•æ¥æ”¶ä¸€ä¸ª<code>Callback</code>ç±»å‹çš„å‚æ•°ï¼Œæ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åœ¨<code>Callback</code>ä¸­è¿›è¡Œçš„ã€‚<code>Callback</code>æ˜¯<code>ItemTouchHelper</code>çš„ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œéœ€è¦æˆ‘ä»¬é‡å†™çš„æ–¹æ³•æœ‰è¿™æ ·å‡ ä¸ªï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨æˆ–è€…æ‹–æ‹½çš„æ–¹å‘ï¼Œä¸Šä¸‹å·¦å³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> recyclerView ç›®æ ‡RecyclerView</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder ç›®æ ‡ViewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–¹å‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMovementFlags</span><span class="params">(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‹–æ‹½itemç§»åŠ¨æ—¶äº§ç”Ÿå›è°ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> recyclerView ç›®æ ‡RecyclerView</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder æ‹–æ‹½çš„itemå¯¹åº”çš„viewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target æ‹–æ‹½ç›®çš„åœ°çš„ViewHOlder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æ¶ˆè´¹æ‹–æ‹½äº‹ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMove</span><span class="params">(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder, RecyclerView.ViewHolder target)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨åˆ é™¤æ—¶å›è°ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder å½“å‰æ“ä½œçš„Itemå¯¹åº”çš„viewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> direction æ–¹å‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSwiped</span><span class="params">(RecyclerView.ViewHolder viewHolder, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å¯ä»¥é•¿æŒ‰æ‹–æ‹½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLongPressDragEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å¯ä»¥æ»‘åŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isItemViewSwipeEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰è¿™æ ·5ä¸ªæ–¹æ³•ï¼Œç”¨æ¥æ§åˆ¶æ˜¯å¦å¯åˆ’åŠ¨åˆ é™¤ï¼Œæ˜¯å¦å¯é•¿æŒ‰æ‹–æ‹½ï¼Œæ»‘åŠ¨æ—¶å›è°ƒï¼Œæ‹–æ‹½æ—¶å›è°ƒä»¥åŠæ»‘åŠ¨æ‹–æ‹½æ–¹å‘ã€‚å¥½äº†ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“çš„å®ç°æ˜¯æ€ä¹ˆæ ·çš„ã€‚</p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>é¦–å…ˆï¼Œåˆå§‹åŒ–<code>RecyclerView</code>ã€åˆå§‹åŒ–<code>Adapter</code>ã€ç»‘å®šé€‚é…å™¨ç­‰ç­‰è€ç”Ÿå¸¸è°ˆçš„ä¸œè¥¿ï¼Œä¸ç»†è¯´äº†ï¼Œæœ‰ç–‘é—®çš„æœ‹å‹å¯ä»¥çœ‹ä»£ç ã€‚</p>
<p>æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ä¸‹<code>ItemTouchHelper</code>çš„ä½¿ç”¨ï¼Œé¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªç±»ç»§æ‰¿<code>ItemTouchHelper</code>(å…¶å®ä¸ç»§æ‰¿ï¼Œç›´æ¥ä½¿ç”¨<code>ItemTouchHelper</code>ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡æˆ‘è¿™é‡Œä¸ºäº†ä¾¿äºæ§åˆ¶ï¼Œä»¥åŠå…¶ä»–ä¸€äº›åŠŸèƒ½å®ç°ï¼Œé€‰æ‹©ç»§æ‰¿è¯¥ç±»)ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookShelfTouchHelper</span> <span class="keyword">extends</span> <span class="title">ItemTouchHelper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TouchCallback callback;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BookShelfTouchHelper</span><span class="params">(TouchCallback callback)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(callback);</span><br><span class="line">        <span class="keyword">this</span>.callback = callback;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnableDrag</span><span class="params">(<span class="keyword">boolean</span> enableDrag)</span> </span>&#123;</span><br><span class="line">        callback.setEnableDrag(enableDrag);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnableSwipe</span><span class="params">(<span class="keyword">boolean</span> enableSwipe)</span> </span>&#123;</span><br><span class="line">        callback.setEnableSwipe(enableSwipe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªç®€å•çš„è®¾ç½®æ»‘åŠ¨åˆ é™¤å’Œæ‹–æ‹½çš„å¼€å…³ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä¼ é€’ç»™<code>Callback</code>è®©å…¶æ¥å¤„ç†ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>Callback</code>å­ç±»çš„ç¼–å†™ï¼Œè¿™é‡Œæ˜¯é‡ç‚¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TouchCallback</span> <span class="keyword">extends</span> <span class="title">ItemTouchHelper</span>.<span class="title">Callback</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isEnableSwipe;<span class="comment">//å…è®¸æ»‘åŠ¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isEnableDrag;<span class="comment">//å…è®¸æ‹–åŠ¨</span></span><br><span class="line">    <span class="keyword">private</span> OnItemTouchCallbackListener callbackListener;<span class="comment">//å›è°ƒæ¥å£</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TouchCallback</span><span class="params">(OnItemTouchCallbackListener callbackListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.callbackListener = callbackListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨æˆ–è€…æ‹–æ‹½çš„æ–¹å‘ï¼Œä¸Šä¸‹å·¦å³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> recyclerView ç›®æ ‡RecyclerView</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder ç›®æ ‡ViewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–¹å‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMovementFlags</span><span class="params">(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder)</span> </span>&#123;</span><br><span class="line">        RecyclerView.LayoutManager layoutManager = recyclerView.getLayoutManager();</span><br><span class="line">        <span class="keyword">if</span> (layoutManager <span class="keyword">instanceof</span> GridLayoutManager) &#123;<span class="comment">// GridLayoutManager</span></span><br><span class="line">            <span class="comment">// flagå¦‚æœå€¼æ˜¯0ï¼Œç›¸å½“äºè¿™ä¸ªåŠŸèƒ½è¢«å…³é—­</span></span><br><span class="line">            <span class="keyword">int</span> dragFlag = ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT | ItemTouchHelper.UP | ItemTouchHelper.DOWN;</span><br><span class="line">            <span class="keyword">int</span> swipeFlag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> makeMovementFlags(dragFlag, swipeFlag);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (layoutManager <span class="keyword">instanceof</span> LinearLayoutManager) &#123;<span class="comment">// linearLayoutManager</span></span><br><span class="line">            LinearLayoutManager linearLayoutManager = (LinearLayoutManager) layoutManager;</span><br><span class="line">            <span class="keyword">int</span> orientation = linearLayoutManager.getOrientation();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> dragFlag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> swipeFlag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (orientation == LinearLayoutManager.HORIZONTAL) &#123;<span class="comment">//æ¨ªå‘å¸ƒå±€</span></span><br><span class="line">                swipeFlag = ItemTouchHelper.UP | ItemTouchHelper.DOWN;</span><br><span class="line">                dragFlag = ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (orientation == LinearLayoutManager.VERTICAL) &#123;<span class="comment">//çºµå‘å¸ƒå±€</span></span><br><span class="line">                dragFlag = ItemTouchHelper.UP | ItemTouchHelper.DOWN;</span><br><span class="line">                swipeFlag = ItemTouchHelper.LEFT | ItemTouchHelper.RIGHT;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> makeMovementFlags(dragFlag, swipeFlag);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‹–æ‹½itemç§»åŠ¨æ—¶äº§ç”Ÿå›è°ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> recyclerView ç›®æ ‡RecyclerView</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder æ‹–æ‹½çš„itemå¯¹åº”çš„viewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target æ‹–æ‹½ç›®çš„åœ°çš„ViewHOlder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æ¶ˆè´¹æ‹–æ‹½äº‹ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMove</span><span class="params">(RecyclerView recyclerView, RecyclerView.ViewHolder viewHolder, RecyclerView.ViewHolder target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.callbackListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.callbackListener.onMove(viewHolder.getAdapterPosition(),target.getAdapterPosition());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨åˆ é™¤æ—¶å›è°ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> viewHolder å½“å‰æ“ä½œçš„Itemå¯¹åº”çš„viewHolder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> direction æ–¹å‘</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSwiped</span><span class="params">(RecyclerView.ViewHolder viewHolder, <span class="keyword">int</span> direction)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.callbackListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.callbackListener.onSwiped(viewHolder.getAdapterPosition());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å¯ä»¥é•¿æŒ‰æ‹–æ‹½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLongPressDragEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isEnableDrag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å¯ä»¥æ»‘åŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isItemViewSwipeEnabled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isEnableSwipe;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnableDrag</span><span class="params">(<span class="keyword">boolean</span> enableDrag)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isEnableDrag = enableDrag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEnableSwipe</span><span class="params">(<span class="keyword">boolean</span> enableSwipe)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isEnableSwipe = enableSwipe;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ä»£ç é›†ä¸­åœ¨äº†<code>getMovementFlags</code>è·å–æ»‘åŠ¨ã€æ‹–æ‹½æ–¹å‘è¿™ä¸ªæ–¹æ³•ä¸Šäº†ï¼Œæ»‘åŠ¨ä»¥åŠæ‹–æ‹½çš„å›è°ƒåè€Œä»£ç è¾ƒå°‘ï¼Œè¿™é‡Œæ˜¯å› ä¸ºè®¾ç½®äº†ä»£ç†ï¼Œä½¿ç”¨<code>OnItemTouchCallbackListener</code>è¿™ä¸€æ¥å£æ¥å¤„ç†ä¸¤ä¸ªäº‹ä»¶ï¼Œèªæ˜çš„æœ‹å‹ä¸€å®šå·²ç»æƒ³åˆ°äº†ï¼Œä½¿ç”¨Activityæ¥å®ç°è¿™ä¸€æ¥å£ï¼Œä»è€Œå®ç°ç®¡ç†å›è°ƒçš„åŠŸèƒ½ï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnItemTouchCallbackListener</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“æŸä¸ªItemè¢«æ»‘åŠ¨åˆ é™¤æ—¶å›è°ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onSwiped</span><span class="params">(<span class="keyword">int</span> adapterPosition)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“ä¸¤ä¸ªItemä½ç½®äº’æ¢çš„æ—¶å€™è¢«å›è°ƒ(æ‹–æ‹½)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> srcPosition    æ‹–æ‹½çš„itemçš„position</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> targetPosition ç›®çš„åœ°çš„Itemçš„position</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¼€å‘è€…å¤„ç†äº†æ“ä½œåº”è¯¥è¿”å›trueï¼Œå¼€å‘è€…æ²¡æœ‰å¤„ç†å°±è¿”å›false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">onMove</span><span class="params">(<span class="keyword">int</span> srcPosition, <span class="keyword">int</span> targetPosition)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªæ‹–æ‹½ï¼Œä¸€ä¸ªæ»‘åŠ¨ã€‚æ¥ç€åœ¨<code>Activity</code>ä¸­ç»‘å®š<code>ItemTouchHelper</code>å’Œ<code>RecyclerView</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    touchHelper = <span class="keyword">new</span> BookShelfTouchHelper(<span class="keyword">new</span> TouchCallback(<span class="keyword">this</span>));</span><br><span class="line">    touchHelper.setEnableDrag(<span class="keyword">true</span>);</span><br><span class="line">    touchHelper.setEnableSwipe(<span class="keyword">true</span>);</span><br><span class="line">    touchHelper.attachToRecyclerView(rvBooks);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¹¶ä½¿<code>Activity</code>å®ç°<code>OnItemTouchCallbackListener</code>æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSwiped</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¤„ç†åˆ’åŠ¨åˆ é™¤æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>(books != <span class="keyword">null</span> &amp;&amp; position &gt;= <span class="number">0</span> &amp;&amp; position &lt; books.size()) &#123;</span><br><span class="line">        books.remove(position);</span><br><span class="line">        adapter.notifyItemRemoved(position);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMove</span><span class="params">(<span class="keyword">int</span> srcPosition, <span class="keyword">int</span> targetPosition)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¤„ç†æ‹–æ‹½äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span>(books == <span class="keyword">null</span> || books.size() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(srcPosition &gt;= <span class="number">0</span> &amp;&amp; srcPosition &lt; books.size() &amp;&amp; targetPosition &gt;= <span class="number">0</span> &amp;&amp; targetPosition &lt; books.size()) &#123;</span><br><span class="line">        <span class="comment">//äº¤æ¢æ•°æ®æºä¸¤ä¸ªæ•°æ®çš„ä½ç½®</span></span><br><span class="line">        Collections.swap(books,srcPosition,targetPosition);</span><br><span class="line">        <span class="comment">//æ›´æ–°è§†å›¾</span></span><br><span class="line">        adapter.notifyItemMoved(srcPosition,targetPosition);</span><br><span class="line">        <span class="comment">//æ¶ˆè´¹äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>books</code>ä½¿æ•°æ®æºï¼Œåˆ é™¤æ“ä½œå¾ˆç®€å•ï¼Œ<code>remove</code>å³å¯ã€‚æ‹–æ‹½æ—¶éœ€è¦å…ˆæ›´æ–°æ•°æ®æºï¼Œæ¥ç€æ›´æ–°è§†å›¾ï¼Œä¹‹åè¿”å›<code>true</code>æ¶ˆè´¹è¯¥äº‹ä»¶ã€‚åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ‹–æ‹½æ’åºçš„åŠŸèƒ½å°±å®ç°äº†ã€‚</p>
<p>ä½†æ˜¯æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œå¦‚æœæˆ‘è¦æ±‚æœ€åä¸€ä¸ªæŒ‰é’®æ˜¯ä¸€ä¸ªå¢åŠ çš„æŒ‰é’®ï¼Œå®ƒä¸å‚ä¸æ’åºï¼Œé‚£è¦æ€ä¹ˆåšå‘¢ï¼Ÿæœ€å¼€å§‹æˆ‘çš„æƒ³æ³•æ˜¯åœ¨<code>onMove</code>æ–¹æ³•ä¸­å»æ‹¦æˆªï¼Œä½†æ˜¯ä»”ç»†æƒ³æƒ³è¿™æ ·åˆæœ‰äº›ä¸å¯¹ï¼Œå› ä¸º<code>onMove</code>å·²ç»è°ƒç”¨åœ¨æ‹–æ‹½ä¹‹åäº†ã€‚åæ¥æ²¡æ€è·¯ï¼Œçœ‹åˆ°<code>ItemTouchHelper</code>ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startDrag</span><span class="params">(ViewHolder viewHolder)</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸æ˜¯å¼€å§‹æ‹–æ‹½çš„èµ·ç‚¹å—ï¼Œé‚£æˆ‘ä»è¿™é‡Œå¼€å§‹æ‹¦æˆªä¸å°±å¥½äº†ï¼Œç„¶è€Œï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨</p>
<p>å†æŸ¥æŸ¥ï¼Œå‘ç°æ­¤æ–¹æ³•æ˜¯è¦æ‰‹åŠ¨è°ƒç”¨çš„ï¼Œokï¼Œ<code>isLongPressDragEnabled</code>æ–¹æ³•è¿”å›<code>false</code>ï¼Œç»™<code>ViewHolder</code>çš„<code>rootView</code>å¢åŠ é•¿æŒ‰äº‹ä»¶ï¼Œåœ¨é•¿æŒ‰äº‹ä»¶ä¸­å¼€å§‹æ‰‹åŠ¿ã€‚æå®šã€‚</p>
<p>ps:<strong>æ³¨æ„è¿™ä¸€æ­¥å®Œæˆååªæ˜¯æ·»åŠ æŒ‰é’®ä¸èƒ½è¢«æ‹–æ‹½ï¼Œè¿˜è¦é˜²æ­¢è¯¥æŒ‰é’®è¢«å…¶ä»–æŒ‰é’®æ›´æ¢ä½ç½®ï¼Œå› æ­¤éœ€è¦åœ¨<code>onMove</code>æ–¹æ³•ä¸­åˆ¤æ–­<code>targetViewHolder</code>çš„ä½ç½®ã€‚</strong></p>
<p>okï¼Œæˆ‘ä»¬ç°åœ¨åªå‰©ä¸‹ä¸€ä¸ªå·¥ä½œäº†ï¼Œä¿å­˜æ‹–æ‹½åçš„æ•°æ®ã€‚æˆ‘è¿™é‡Œé€‰æ‹©ä½¿ç”¨<code>Gson</code>ä¸<code>SharedPreference</code>ç»“åˆä½¿ç”¨ï¼Œç±»å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SP_NAME = <span class="string">&quot;DEFAULT_SP_NAME&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">saveData</span><span class="params">(List&lt;T&gt; data, String spName, String key, Context context)</span> </span>&#123;</span><br><span class="line">        SharedPreferences preferences = context.getSharedPreferences(spName,Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.Editor editor = preferences.edit();</span><br><span class="line">        Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">        String jsonString = gson.toJson(data);</span><br><span class="line">        editor.putString(key,jsonString);</span><br><span class="line">        editor.apply();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Book&gt; <span class="title">getData</span><span class="params">(String spName, String key, Context context)</span> </span>&#123;</span><br><span class="line">        List&lt;Book&gt; data = <span class="keyword">new</span> ArrayList&lt;Book&gt;();</span><br><span class="line">        SharedPreferences preferences = context.getSharedPreferences(spName,Context.MODE_PRIVATE);</span><br><span class="line">        String jsonString = preferences.getString(key,<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span>(jsonString == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125;</span><br><span class="line">        Log.e(<span class="string">&quot;JSON&quot;</span>,jsonString + <span class="string">&quot;ssss&quot;</span>+<span class="keyword">new</span> TypeToken&lt;List&lt;Book&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line">        Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">        data = gson.fromJson(jsonString,<span class="keyword">new</span> TypeToken&lt;List&lt;Book&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœŸé—´<code>Java</code>æ³›å‹æ“¦é™¤çš„é—®é¢˜æå¾—æˆ‘å¤´ç—›ï¼Œå…³äºæ³›å‹æ“¦é™¤å¯ä»¥æŸ¥çœ‹<a href="/articles/Java/Base/JavaGernericParadigm/">JavaåŸºç¡€â€“æ³›å‹</a></p>
<h3 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h3><p>okï¼Œæœ€åæ˜¯æ¼”ç¤ºæ•ˆæœï¼š</p>
<p><img src="/images/%E6%8B%96%E5%8A%A8%E6%8E%92%E5%BA%8FRecyclerView.gif"></p>
<p>å¥½äº†ï¼Œä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åšå®¢çš„å…¨éƒ¨å†…å®¹äº†ï¼Œå¦‚æœæ‚¨å¯¹æœ¬æ–‡æœ‰ä»»ä½•ç–‘é—®æˆ–è€…æ–‡ç« æœ‰é”™è¯¯æˆ–è€…é—æ¼ï¼Œè¯·åœ¨è¯„è®ºç•™è¨€å‘Šè¯‰æˆ‘ï¼Œä¸èƒœæ„Ÿæ¿€~</p>
<p>æœ¬æ–‡ä»£ç åœ°å€<a target="_blank" rel="noopener" href="https://github.com/riceeater/DraggingSortDemo">github</a>ï¼Œæ¬¢è¿fork~</p>
<p>enjoy~</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/AndroidçŸ¥è¯†ä½“ç³»/">AndroidçŸ¥è¯†ä½“ç³»</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Androidå®æˆ˜/">Androidå®æˆ˜</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2020 å°ç±³ç²’
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>