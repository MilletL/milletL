<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android轮播图-自定义无限滚动的广告Banner控件 | RiceEater的小小世界 | My Life&#39;s Getting Better.</title>

  
  <meta name="author" content="小米粒">
  

  
  <meta name="description" content="今天闲来无事，梳理一下关于Android中广告banner图的一些技巧。
一般来说，我们的广告Banner要满足这样几个条件：

Banner单个Item无限循环
自动滚动
响应单独item点击事件
触摸禁止滑动
指示条
画廊效果

ok，下面我们就针对这几点一一来进行分析
Banner单个Item无限循环首先我们要实现一个自动滚动和手动均可滚动的Banner，很显然，我们需要使用到ViewPager(当然也可以使用RecyclerView，不过我个人感觉在使用难度上，前者会小一点)。实现无限循环的方式有这样两种：
假无限这种方法是在原数据队头队尾各新增一条数据，新的数据集首位为原数据末尾数据，其末尾为原数据首位数据，中间为原数据
此循环ViewPager的思路是将第0位item与倒数第二位映射，将最后一位与第一位元素映射，在选中第0位或者最后一位时，设置为相应的位置。这种方法可以实现循环滚动，但是存在问题，重置ViewPager位置时不能使用切换动画，如果使用了自定义动画，切换会出现问题，因此该方式不作考虑。">
  

  
  <meta name="keywords" content="RiceEater 小米粒 riceeater.info">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Android轮播图-自定义无限滚动的广告Banner控件"/>

  <meta property="og:site_name" content="RiceEater的小小世界"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="RiceEater的小小世界" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.1.1"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">RiceEater的小小世界</a>
    </h1>
    <p class="site-description">My Life&#39;s Getting Better.</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/plans">计划</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>Android轮播图-自定义无限滚动的广告Banner控件</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/articles/Android/View/BannerView/" rel="bookmark">
        <time class="entry-date published" datetime="2018-06-07T12:40:32.000Z">
          2018-06-07
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>今天闲来无事，梳理一下关于Android中广告banner图的一些技巧。</p>
<p>一般来说，我们的广告Banner要满足这样几个条件：</p>
<ul>
<li><code>Banner</code>单个Item无限循环</li>
<li>自动滚动</li>
<li>响应单独item点击事件</li>
<li>触摸禁止滑动</li>
<li>指示条</li>
<li>画廊效果</li>
</ul>
<p>ok，下面我们就针对这几点一一来进行分析</p>
<h3 id="Banner单个Item无限循环"><a href="#Banner单个Item无限循环" class="headerlink" title="Banner单个Item无限循环"></a>Banner单个Item无限循环</h3><p>首先我们要实现一个自动滚动和手动均可滚动的Banner，很显然，我们需要使用到<code>ViewPager</code>(当然也可以使用<code>RecyclerView</code>，不过我个人感觉在使用难度上，前者会小一点)。实现无限循环的方式有这样两种：</p>
<h4 id="假无限"><a href="#假无限" class="headerlink" title="假无限"></a>假无限</h4><p>这种方法是在原数据队头队尾各新增一条数据，新的数据集首位为原数据末尾数据，其末尾为原数据首位数据，中间为原数据</p>
<p>此循环<code>ViewPager</code>的思路是将第0位item与倒数第二位映射，将最后一位与第一位元素映射，在选中第0位或者最后一位时，设置为相应的位置。这种方法可以实现循环滚动，但是存在问题，重置<code>ViewPager</code>位置时不能使用切换动画，如果使用了自定义动画，切换会出现问题，因此该方式不作考虑。</p>
<a id="more"></a>

<h4 id="真无限"><a href="#真无限" class="headerlink" title="真无限"></a>真无限</h4><p>另一种是实现思路就是本篇博客采用的方式。对<code>ViewPager</code>的适配器进行一些改造，直接看代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">BannerAdapter</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">PagerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; data;<span class="comment">//数据源</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> notify = <span class="keyword">false</span>;<span class="comment">//手动更改了数据源标志位，解决notifyDataSetChanged不起作用的问题</span></span><br><span class="line">    <span class="keyword">private</span> BaseBannerViewHolder&lt;T&gt; holder;<span class="comment">//生成对应View并处理View事件</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isInfinity;<span class="comment">//是否允许无限轮播</span></span><br><span class="line">    <span class="keyword">private</span> OnPageClickListener onPageClickListener;<span class="comment">//item点击回调</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BannerAdapter</span><span class="params">(Context context,<span class="keyword">boolean</span> isInfinity)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isInfinity = isInfinity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">instantiateItem</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup container, <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        View view = getView(container,position);</span><br><span class="line">        container.addView(view);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 生成对应的View</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> container</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> position</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> View <span class="title">getView</span><span class="params">(ViewGroup container, <span class="keyword">final</span> <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        View view = holder.createView();</span><br><span class="line">        view.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(onPageClickListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    onPageClickListener.onPageClick(position % getRealCount());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        holder.bind(position % getRealCount(),data.get(position % getRealCount()));</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroyItem</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup container, <span class="keyword">int</span> position, <span class="meta">@NonNull</span> Object object)</span> </span>&#123;</span><br><span class="line">        container.removeView((View)object);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 无限模式返回Int最大值，否则返回真实个数</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isInfinity) &#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.MAX_VALUE;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> getRealCount();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 返回数据源真实个数</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRealCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data == <span class="keyword">null</span> ? <span class="number">0</span> : data.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 获取初始化第一个item位置</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFirstPosition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(getRealCount() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(isInfinity) &#123;</span><br><span class="line">            <span class="comment">//无限模式下从Int最大值中间开始，若从0开始则无法左滑</span></span><br><span class="line">            <span class="keyword">int</span> center = Integer.MAX_VALUE/<span class="number">2</span>;</span><br><span class="line">            center = center - center % getRealCount();</span><br><span class="line">            <span class="keyword">return</span> center;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isViewFromObject</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@NonNull</span> Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> view == object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 更新数据源，设置刷新标志</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(List&lt;T&gt; data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        <span class="keyword">this</span>.notify = <span class="keyword">true</span>;</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">        <span class="keyword">this</span>.notify = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 重写该方法以防止notifyDataSetChanged不生效</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> object</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemPosition</span><span class="params">(<span class="meta">@NonNull</span> Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(notify) &#123;</span><br><span class="line">            <span class="keyword">return</span> POSITION_NONE;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.getItemPosition(object);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHolder</span><span class="params">(BaseBannerViewHolder&lt;T&gt; holder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.holder = holder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnPageClickListener</span><span class="params">(OnPageClickListener onPageClickListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.onPageClickListener = onPageClickListener;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码注释非常清楚了，主要逻辑在于<code>getCount</code>和<code>getFirstPosition</code>这两个方法，<code>getCount</code>返回一个极大数可以保证无限滑动的可能性，<code>getFirstPosition</code>从中间开始取是为了保证刚开始能够左滑。这里我将<code>Adapter</code>生成<code>View</code>的逻辑交给了<code>ViewHolder</code>去完成，对应的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 小米Xylitol</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@email</span> xiaomi987@hotmail.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> ViewPager视图生成工具</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018-06-07 16:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BaseBannerViewHolder</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">View <span class="title">createView</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bind</span><span class="params">(<span class="keyword">int</span> position,T bean)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BannerViewHolder</span> <span class="keyword">implements</span> <span class="title">BaseBannerViewHolder</span>&lt;<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context;</span><br><span class="line">    <span class="keyword">private</span> TextView tvBanner;</span><br><span class="line">    <span class="keyword">private</span> ImageView ivBanner;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BannerViewHolder</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">createView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        View view = LayoutInflater.from(context).inflate(R.layout.item_banner,<span class="keyword">null</span>,<span class="keyword">false</span>);</span><br><span class="line">        tvBanner = view.findViewById(R.id.tv_banner);</span><br><span class="line">        ivBanner = view.findViewById(R.id.iv_banner);</span><br><span class="line">        <span class="keyword">return</span> view;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(<span class="keyword">int</span> position,String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(position % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            ivBanner.setBackgroundColor(<span class="number">0xffff0000</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(position % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            ivBanner.setBackgroundColor(<span class="number">0xff00ff00</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ivBanner.setBackgroundColor(<span class="number">0xff0000ff</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        tvBanner.setText(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单的逻辑，不再多说，哦对了别忘了在给对应View设置数据时使用的position需要转成对应的realPosition，不然会出现数组越界的问题</p>
<h3 id="自动滚动"><a href="#自动滚动" class="headerlink" title="自动滚动"></a>自动滚动</h3><p>自动滚动功能，我这里使用了我们的老朋友Handler，使用Handler发出演示意图，并在意图中在此发出一个延时意图，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Handler handler = <span class="keyword">new</span> Handler();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Runnable loopRunnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isLoop &amp;&amp; !isTouch) &#123;</span><br><span class="line">            <span class="keyword">int</span> currentItem = viewPager.getCurrentItem();</span><br><span class="line">            currentItem++;</span><br><span class="line">            viewPager.setCurrentItem(currentItem,<span class="keyword">true</span>);</span><br><span class="line">            startScroll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 开始自动滚动</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startScroll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    handler.removeCallbacksAndMessages(<span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">if</span>(isLoop) &#123;</span><br><span class="line">        handler.postDelayed(loopRunnable, delayMillis);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 暂停自动滚动</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stopScroll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    handler.removeCallbacksAndMessages(<span class="keyword">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在相应的初始化逻辑中调用<code>startScroll</code>即可开始自动滚动，若不需要滚动时，调用<code>stopScroll</code>即可停止自动滚动。</p>
<h3 id="触摸禁止滑动"><a href="#触摸禁止滑动" class="headerlink" title="触摸禁止滑动"></a>触摸禁止滑动</h3><p>这个功能较为简单，重写<code>OnTouchListener</code>，判断手势，然后作相应的处理即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">viewPager.setOnTouchListener(<span class="keyword">new</span> OnTouchListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.getAction()) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                isTouch = <span class="keyword">true</span>;</span><br><span class="line">                stopScroll();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                isTouch = <span class="keyword">false</span>;</span><br><span class="line">                startScroll();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>可以看到我们定义了一个手指触摸的标志位，在手指按下和滑动时置为true，并停止自动滚动，在手机抬起和取消触摸时将其设置为false，并且开启自动滚动</p>
<h3 id="响应单独item点击事件"><a href="#响应单独item点击事件" class="headerlink" title="响应单独item点击事件"></a>响应单独item点击事件</h3><p>响应单独的点击事件，我这里写了一个接口来做：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnPageClickListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onPageClick</span><span class="params">(<span class="keyword">int</span> position)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在Adapter中对相应的View进行设置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 生成对应的View</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> container</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> position</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> View <span class="title">getView</span><span class="params">(ViewGroup container, <span class="keyword">final</span> <span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">    View view = holder.createView();</span><br><span class="line">    view.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(onPageClickListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">                onPageClickListener.onPageClick(position % getRealCount());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    holder.bind(position % getRealCount(),data.get(position % getRealCount()));</span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="指示条"><a href="#指示条" class="headerlink" title="指示条"></a>指示条</h3><p>指示条这个东西因为样式有很多差异的，有些Banner喜欢使用数字表示，有些喜欢使用圆点，我这里选择用接口的方式来实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 小米Xylitol</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@email</span> xiaomi987@hotmail.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 指示器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018-06-07 17:15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PagerIndicator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setCurrentItem</span><span class="params">(<span class="keyword">int</span> position)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">attachView</span><span class="params">(ViewGroup viewGroup)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到只有两个方法，一个是将<code>indicator</code>指示器加入到<code>BannerView</code>，一个是设置当前滑动的位置，在<code>BannerView</code>中在相应的位置进行调用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置指示器</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initIndicator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(indicator != <span class="keyword">null</span>) &#123;</span><br><span class="line">        indicator.attachView(<span class="keyword">this</span>);</span><br><span class="line">        viewPager.addOnPageChangeListener(<span class="keyword">new</span> ViewPager.OnPageChangeListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrolled</span><span class="params">(<span class="keyword">int</span> position, <span class="keyword">float</span> positionOffset, <span class="keyword">int</span> positionOffsetPixels)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageSelected</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">                indicator.setCurrentItem(position % adapter.getRealCount());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrollStateChanged</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置指示器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> indicator</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIndicator</span><span class="params">(PagerIndicator indicator)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.indicator = indicator;</span><br><span class="line">    initIndicator();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我这里实现了一个圆点的指示器，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 小米Xylitol</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@email</span> xiaomi987@hotmail.com</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 圆点指示器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018-06-07 17:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CirclePageIndicator</span> <span class="keyword">implements</span> <span class="title">PagerIndicator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> List&lt;ImageView&gt; imageViewList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> currentItem = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CirclePageIndicator</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.size = size;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCurrentItem</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentItem = position;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; imageViewList.size();i++) &#123;</span><br><span class="line">            ImageView imageView = imageViewList.get(i);</span><br><span class="line">            <span class="keyword">if</span>(i == currentItem) &#123;</span><br><span class="line">                imageView.setImageResource(R.drawable.indicator_selected);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                imageView.setImageResource(R.drawable.indicator_normal);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attachView</span><span class="params">(ViewGroup viewGroup)</span> </span>&#123;</span><br><span class="line">        LinearLayout linearLayout = <span class="keyword">new</span> LinearLayout(viewGroup.getContext());</span><br><span class="line">        linearLayout.setGravity(Gravity.CENTER);</span><br><span class="line">        linearLayout.setOrientation(LinearLayout.HORIZONTAL);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; size;i++) &#123;</span><br><span class="line">            ImageView imageView = <span class="keyword">new</span> ImageView(viewGroup.getContext());</span><br><span class="line">            <span class="keyword">if</span>(i == currentItem) &#123;</span><br><span class="line">                imageView.setImageResource(R.drawable.indicator_selected);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                imageView.setImageResource(R.drawable.indicator_normal);</span><br><span class="line">            &#125;</span><br><span class="line">            imageViewList.add(imageView);</span><br><span class="line">            linearLayout.addView(imageView);</span><br><span class="line">            <span class="keyword">if</span>(i != size - <span class="number">1</span>) &#123;</span><br><span class="line">                ViewGroup.MarginLayoutParams marginLayoutParams = (ViewGroup.MarginLayoutParams) imageView.getLayoutParams();</span><br><span class="line">                marginLayoutParams.rightMargin = BannerView.dpToPx(<span class="number">5</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        viewGroup.addView(linearLayout);</span><br><span class="line">        RelativeLayout.LayoutParams params = (RelativeLayout.LayoutParams) linearLayout.getLayoutParams();</span><br><span class="line">        params.width = RelativeLayout.LayoutParams.MATCH_PARENT;</span><br><span class="line">        params.height = BannerView.dpToPx(<span class="number">15</span>);</span><br><span class="line">        params.addRule(RelativeLayout.CENTER_HORIZONTAL);</span><br><span class="line">        params.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM);</span><br><span class="line">        linearLayout.setBackgroundColor(<span class="number">0x33000000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="画廊效果"><a href="#画廊效果" class="headerlink" title="画廊效果"></a>画廊效果</h3><p>画廊效果说穿了其实就是对ViewGroup中clipChildren属性的使用，该属性的作用是是否不允许子View突破父控件的大小，默认为true，即默认不突破父控件大小，我们这里要实现画廊效果，就需要给BannerView的根View设置其clipChildren属性为false，具体逻辑如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置Banner展示左右两侧其余banner</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> nesting</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> margin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNesting</span><span class="params">(<span class="keyword">boolean</span> nesting,<span class="keyword">int</span> margin)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.isNesting = nesting;</span><br><span class="line">    setClipChildren(!isNesting);</span><br><span class="line">    <span class="keyword">if</span>(!isNesting) &#123;</span><br><span class="line">        MarginLayoutParams params = (MarginLayoutParams) viewPager.getLayoutParams();</span><br><span class="line">        params.leftMargin = dpToPx(margin);</span><br><span class="line">        params.rightMargin = dpToPx(margin);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意如果在设置了false之后，不对<code>ViewPager</code>进行<code>margin</code>的设置，那样还是不会出现预想的效果，因为屏幕宽度已经被占满了</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>最后，使用起来是这样的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.xylitolz.androidbannerview.BannerView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/banner_view&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;120dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:delayMillis</span>=<span class="string">&quot;2000&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:loop</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:infinity</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者在代码中使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line">    bannerView = findViewById(R.id.banner_view);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> List&lt;String&gt; data = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    data.add(<span class="string">&quot;Banner0&quot;</span>);</span><br><span class="line">    data.add(<span class="string">&quot;Banner1&quot;</span>);</span><br><span class="line">    data.add(<span class="string">&quot;Banner2&quot;</span>);</span><br><span class="line">    bannerView.setData(data,<span class="keyword">new</span> BannerViewHolder(<span class="keyword">this</span>));</span><br><span class="line">    bannerView.setNesting(<span class="keyword">true</span>,<span class="number">20</span>);</span><br><span class="line">    bannerView.setIndicator(<span class="keyword">new</span> CirclePageIndicator(data.size()));</span><br><span class="line">    bannerView.setOnPageClickListener(<span class="keyword">new</span> BannerView.OnPageClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageClick</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">            String toast = <span class="string">&quot;this is page &quot;</span> + data.get(position);</span><br><span class="line">            Toast.makeText(MainActivity.<span class="keyword">this</span>,toast,Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上这些就是我在做BannerView时遇到的大部分问题了，还有一些遗漏之处，具体看代码吧，哦等下，先上一个效果图：</p>
<p><img src="/images/%E6%97%A0%E9%99%90%E6%BB%9A%E5%8A%A8%E7%9A%84BannerView.gif"></p>
<p>博客中涉及到的代码地址在<a target="_blank" rel="noopener" href="https://github.com/riceeater/BannerView">github</a>，欢迎fork，与我一起改进这个控件<del>有任何疑问或者文章中有任何错误，请在评论区留言告诉我，不胜感激</del></p>
<p>enjoy~</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Android知识体系/">Android知识体系</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Android实战/">Android实战</a><a href="/tags/自定义View/">自定义View</a>
    </span>
    

    </div>

    
  </div>
</article>

  






    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2020 小米粒
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>